<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        #layer {
            display: none;
        }
    </style>
</head>

<body>
    <div id="wrapper">
        <button id="click">click here</button>
        <div id="layer">i am a float layer</div>
    </div>
        

    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
        crossorigin="anonymous"></script>
    <script>
        // click.addEventListener('click',function () {
        //     layer.style.display='block';
        // })
        // document.addEventListener('click',function(){
        //     layer.style.display='none';
        // },true)
        //demo version 
        //实现点击click,显示浮层，点击别处隐藏浮层，但这里别处包括了浮层本身，而且点击click不能隐藏浮层

        // click.addEventListener('click',function () {
        //     layer.style.display='block';
        // })
        // wrapper.addEventListener('click',function(e){
        //     e.stopPropagation();
        // })
        // document.addEventListener('click',function(){
        //     layer.style.display='none';
        // })
        //方方工作第一年的方案，除基础效果外，点击浮层 浮层不会消失了

        // $('#click').on('click', function () {
        //     console.log(11)
        //     $('#layer').show();
        //     //节省内存方案，只在浮层显示之后再创建一次性的监听
        //     $(document).one('click', function () {
        //         console.log(22);
        //         $('#layer').hide();
        //     })
        // })
        // //如果注释掉下面这段，还是犯了和最开始一样的错误，
        // //即给按钮添加完click事件后，由于冒泡机制的作用，
        // //同时也给document对象添加了监听事件，且立即执行了
        // $('#wrapper').on('click', function (e) {
        //     e.stopPropagation();
        // })
        // $('#click').on('click', function () {
        //     $('#layer').show();
        //     console.log('show');
        //     setTimeout(() => {
        //         console.log('添加one click')
        //         console.log('****************')
        //         $(document).one('click',function(){
        //             console.log('我觉得这里不会执行');
        //             $('#layer').hide();
        //             console.log('----------------')
        //         })
        //     }, 0);
        // })
        // //settimeout是异步的，会在捕获冒泡机制之后执行
        // $(document).on('click',function(){
        //     console.log('clicK事件走到了document');
        // })

        //但是会有一个bug,如果一直点击click来实现show hide
        //在第二次点击click的时候，因为留有上一次保存的hide(),
        //所以这一次的点击会让show 和 hide()同时进行，即又成功地实现了第一次的bug

        $('#click').on('click',function () {
            $('#layer').toggle();
        })
        $('#wrapper').on('click',function (e) {
            e.stopPropagation();
        })
        $(document).on('click',function () {  
            $('#layer').hide();
        })
    </script>
</body>

</html>